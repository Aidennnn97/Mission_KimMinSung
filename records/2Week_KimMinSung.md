# 2Week_김민성.md

## Title: [2Week] 김민성

### 미션 요구사항 분석 & 체크리스트

---
### 필수미션
- [x] 케이스4: 한명의 인스타회원이 다른 인스타회원에게 중복으로 호감표시를 할 수 없습니다.
  - 예를들어 본인의 인스타ID가 aaaa, 상대의 인스타ID가 bbbb 라고 하자.
  - aaaa 는 bbbb 에게 호감을 표시한다.(사유 : 외모)
  - 잠시 후 aaaa 는 bbbb 에게 다시 호감을 표시한다.(사유 : 외모)
  - 이 경우에는 처리되면 안된다.(rq.historyBack)
- [x] 케이스 5 : 한명의 인스타회원이 11명 이상의 호감상대를 등록 할 수 없습니다.
  - 예를들어 본인의 인스타ID가 aaaa 라고 하자.
  - aaaa 는 bbbb, cccc, dddd, eeee, ffff, gggg, hhhh, iiii, jjjj, kkkk 에 대해서 호감표시를 했다.(사유는 상관없음, aaaa는 현재까지 10명에게 호감표시를 했음)
  - 잠시 후 aaaa 는 llll 에게 호감표시를 한다.(사유는 상관없음)
  - 이 경우에는 처리되면 안된다.(rq.historyBack)
- [x] 케이스 6 : 케이스 4 가 발생했을 때 기존의 사유와 다른 사유로 호감을 표시하는 경우에는 성공으로 처리한다.
  - 예를들어 본인의 인스타ID가 aaaa, 상대의 인스타ID가 bbbb 라고 하자.
  - aaaa 는 bbbb 에게 호감을 표시한다.(사유 : 외모)
  - 잠시 후 aaaa 는 bbbb 에게 다시 호감을 표시한다.(사유 : 성격)
  - 이 경우에는 새 호감상대로 등록되지 않고, 기존 호감표시에서 사유만 수정된다.
    - 외모 => 성격
    - resultCode=S-2
    - msg=bbbb 에 대한 호감사유를 외모에서 성격으로 변경합니다.
### 선택미션
- [x] 네이버 로그인
  - 카카오 로그인이 가능한것 처럼, 네이버 로그인으로도 가입 및 로그인 처리가 되도록 해주세요.
    - 스프링 OAuth2 클라이언트로 구현해주세요.
  - 네이버 로그인으로 가입한 회원의 providerTypeCode : NAVER
### 2주차 미션 요약

---

**[접근 방법]**
- 케이스4 : 한명의 인스타 회원이 다른 인스타 회원에게 중복으로 호감표시를 할 수 없습니다.
  1. 현재 유저가 호감상대로 등록한 리스트를 가져옵니다.
  2. 현재 유저가 호감상대로 등록할 인스타 회원을 리스트에 이미 존재하는지 찾습니다.
  3. 이미 존재한다면 rq.historyBack을 수행하고 존재하지 않는다면 등록을 요청합니다.
  
- 케이스 5 : 한명의 인스타회원이 11명 이상의 호감상대를 등록 할 수 없습니다.
  1. 현재 유저가 호감상대로 등록한 리스트를 가져옵니다. 
  2. 리스트의 사이즈가 10 이상이면(이미 10명이 등록되어 있으면) rq.historyBack을 수행합니다.
  
- 케이스 6 : 케이스 4 가 발생했을 때 기존의 사유와 다른 사유로 호감을 표시하는 경우에는 성공으로 처리한다.
  1. 케이스 4의 2번 작업 수행 후 호감사유가 같은지 다른지 확인합니다.
  2. 만약 호감사유가 같다면 "이미 등록된 호감상대 입니다" 경고를 띄우고, 다르다면 서비스에 수정 요청을 합니다.
  3. 서비스에서 요청을 받아 수정시간과 호감사유코드를 수정후 저장해서 응답해 줍니다.

- 네이버 로그인
  1. 네이버 로그인 시 oauthId가 {id=?????} 의 문자열 형태로 가져와지는 것을 확인 합니다.
  2. oauthId를 JSON타입 변환 라이브러리를 사용하여 파싱을 하는 방식으로 접근 하였습니다. 


**[특이사항]**

호감상대를 추가할 때 add 메서드 안에 수정요청하는 로직도 구현되어 있는데
수정부분을 따로 분리해서 구현 해 보는 작업이 필요합니다.

네이버 로그인 id 값을 받아올 때 Json 타입으로 변환하는 방식이아닌 다른 방식도 다시 생각 해 봐야 할 것 같습니다.

- 컨트롤러에서 update 메서드 분리해서 구현.
- 네이버 로그인 id값 가져오는 로직 다시 구현.
